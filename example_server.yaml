# ==== Example server configuration

# Set to e.g. 0.0.0.0:8080 to listen on all interfaces
listenaddr: 127.0.0.1:8080

# If you have the gateway behind a reverse proxy to
# trust the X-Forwarded-For
trustedproxies: []
meters:

    # Name is required to identify the meter in the GET request
  - name: power
    # Device configuration
    device:
      # Device serial connection
      device: /dev/ttyUSB1

      # Set the initial baud rate if necessary (optional)
#      baudrate: 9600

      # Set the baud rate for reading values (optional)
#      baudrateread: 9600

      # Wait before expecting response
#      responsedelay: time.Duration

      # Set a timeout for serial D0 communication (optional)
#      d0timeout: 500ms

      # Device options are optional string flags which can be applied
#      deviceoptions:
#        - "0preamble"

    parser:
      # If the parser shall fail if any OBIS data fails to parse
      # - otherwise the entry will be skipped
      strictmode: false

    # After a request, the value will be cached for this time
    # and will be served to subsequent GET requests. If you do
    # regular polls, choose this value a little smaller than
    # your poll interval.
    ratelimitmaxage: 55s

    # You can specify more than one meter
  - name: heat
    device:
      device: /dev/ttyUSB2
    parser:
      strictmode: false
    # Alternatively, you can specify a cron (optionally 6 values where
    # the first one is seconds) to regularly poll for the meter values.
    # Server requests will render the last cron-triggered result instead
    # of fetching a result on their own. If this entry is set, cron fetching
    # is used, otherwise a per-request fetch (with optional ratelimitmaxage)
    # is done.
    cron: "0/10 * * * * ?"
  - name: smartmeter1
    sml: true
    device:
      device: /dev/ttyUSB3
    parser:
      strictmode: false
    # Alternatively, you can specify a cron (optionally 6 values where
    # the first one is seconds) to regularly poll for the meter values.
    # Server requests will render the last cron-triggered result instead
    # of fetching a result on their own. If this entry is set, cron fetching
    # is used, otherwise a per-request fetch (with optional ratelimitmaxage)
    # is done.
    cron: "0/10 * * * * ?"
